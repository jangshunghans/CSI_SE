<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>123-01-06</title>
    <style>
        body {
            font-family: 'Malgun Gothic', '맑은 고딕', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        p {
            margin: 10px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        table, th, td {
            border: 2px solid #999;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
                table tr td:first-child,
        table tr td:nth-child(2) {
            text-align: center;
        }
        table tr:first-child td:nth-child(3),
        table tr th:nth-child(3) {
            text-align: center;
        }
        table tr:not(:first-child) td:nth-child(3) {
            text-align: left;
        }
        .btn-wrap {
            margin: 16px 0;
        }
        .btn-wrap button {
            font-family: 'Malgun Gothic', '맑은 고딕', Arial, sans-serif;
            padding: 8px 20px;
            margin-right: 10px;
            font-size: 14px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: #f5f5f5;
            color: #333;
            cursor: pointer;
        }
        .btn-wrap button:hover {
            background: #e8e8e8;
        }
        .btn-wrap button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        #editableArea[contenteditable="true"] {
            outline: 1px dashed #4a90d9;
            padding: 4px;
            min-height: 100px;
        }
    </style>
</head>
<body>
<div class="btn-wrap">
    <button type="button" id="btnEdit">수정</button>
    <button type="button" id="btnSave" disabled>저장</button>
</div>
<div id="editableArea" contenteditable="false">
<p>[123-01-06] 무재해운동 세부추진기법 중 5C운동</p>
<table>
<tr>
<td>구분</td>
<td>세부 항목</td>
<td>주요 내용</td>
</tr>
<tr>
<td>개요</td>
<td>5C 운동 정의</td>
<td>작업장에서 기본적으로 지켜야 할 사항인 복장단정(Correctness), 
정리·정돈(Clearance), 청소·청결(Cleaning), 점검·확인(Checking) 
네 가지에 전심·전력(Concentration) 을 더한 다섯 가지 항목의 
머리글자 C에서 이름을 딴 무재해운동의 세부 추진기법</td>
</tr>
<tr>
<td rowspan="5">5C 운동의 
주요 내용</td>
<td>복장단정 (Correctness)</td>
<td>스스로의 자발적 훈련으로 복장단정을 습관화하고, 
몸에 맞는 규정된 복장과 보호구를 착용하여 재해를 예방하도록 하는 활동</td>
</tr>
<tr>
<td>정리·정돈 (Clearance)</td>
<td>작업자 전원이 동시에 실천하고, 필요한 것과 불필요한 것의 기준을 명확히 하여 정리·정돈함으로써 통로 확보, 전도·낙상 등 재해위험을 줄이는 활동</td>
</tr>
<tr>
<td>청소·청결 (Cleaning)</td>
<td>동기부여, 관리자의 지속적 관심과 교육을 통해 청소·청결을 습관화하고, 대상·구역별 담당자 지정, 방법과 주기 설정으로 청소·청결 상태를 유지하는 활동</td>
</tr>
<tr>
<td>점검·확인 (Checking)</td>
<td>일상·정기·특별·수시점검 등 안전점검을 체계적으로 실시하고, 외관·작동·기능·종합점검으로 설비 상태를 확인하며, 이상 발견 시 즉각 시정·상급자 보고·시정요구 및 확인까지 이행하는 활동</td>
</tr>
<tr>
<td>전심·전력 (Concentration)</td>
<td>안전의 중요성과 필요성을 깊이 인식하여 안전에 대한 자각을 높이고, 전 구성원이 참여하는 자율적 안전관리체제를 확립하며, 경영자와 작업자가 일체감을 가지고 안전활동을 추진하여 무재해 활동을 정착시키는 것</td>
</tr>
<tr>
<td colspan="3"></td>
</tr>

</table>
</div>
<script>
(function() {
    var btnEdit = document.getElementById('btnEdit');
    var btnSave = document.getElementById('btnSave');
    var area = document.getElementById('editableArea');

    btnEdit.addEventListener('click', function() {
        area.setAttribute('contenteditable', 'true');
        area.focus();
        btnEdit.disabled = true;
        btnSave.disabled = false;
        area.addEventListener('input', onEditInput);
        area.addEventListener('keyup', onEditInput);
    });

    btnSave.addEventListener('click', function() {
        area.removeEventListener('input', onEditInput);
        area.removeEventListener('keyup', onEditInput);
        area.setAttribute('contenteditable', 'false');
        btnEdit.disabled = false;
        btnSave.disabled = true;

        var html = '<!DOCTYPE html>\n' + document.documentElement.outerHTML;

        function doRefresh() {
            location.reload();
        }

        function fallbackWithDialog() {
            if ('showSaveFilePicker' in window) {
                window.showSaveFilePicker({
                    suggestedName: '123-01-06.html',
                    types: [{ description: 'HTML file', accept: { 'text/html': ['.html'] } }]
                }).then(function(fileHandle) {
                    return fileHandle.createWritable();
                }).then(function(writable) {
                    return writable.write(html).then(function() { return writable.close(); });
                }).then(doRefresh).catch(function(err) {
                    if (err.name !== 'AbortError') alert('저장 실패: ' + (err.message || err));
                    btnSave.disabled = false;
                });
            } else {
                var blob = new Blob([html], { type: 'text/html;charset=utf-8' });
                var a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = '123-01-06.html';
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(a.href);
                setTimeout(doRefresh, 300);
            }
        }

        var filename = (location.pathname || '').replace(/^\//, '') || '123-01-06.html';
        if (!/\.html$/i.test(filename)) filename = filename + '.html';
        var origin = location.origin || (location.protocol + '//' + location.host);

        fetch(origin + '/save', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ filename: filename, content: html })
        }).then(function(r) { return r.json().then(function(d) { return { ok: r.ok, data: d }; }).catch(function() { return { ok: false, data: null }; }); })
          .then(function(result) {
              if (result.ok && result.data && result.data.ok) {
                  doRefresh();
              } else {
                  fallbackWithDialog();
              }
          })
          .catch(function() {
              fallbackWithDialog();
          });
    });
})();
</script>
</body>
</html>